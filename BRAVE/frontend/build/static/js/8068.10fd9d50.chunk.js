"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8068],{58017:(e,t)=>{function n(e){return e.replaceAll(/(.{1,80})/g,"$1\n").trimEnd()}t.UU=void 0,t.UU=function(e){return e.map((e=>">".concat(e.header,"\n").concat(n(e.seq)))).join("\n")}},68068:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var o=n(65043),r=n(70276),a=n(97368),l=n(94496),s=n(19252),c=n(97334),i=n(42788),u=n(62528),m=n(99784),d=n(1273),f=n(92064),g=n(72882),h=n(96233),b=n(72450),p=n(98779),A=n(75270),E=n.n(A),v=n(95629),C=n(91775),w=n(58017),y=n(53223),S=n(95971);const q=(0,r.makeStyles)()({dialogContent:{width:"80em"},textAreaFont:{fontFamily:"Courier New"}});const k=(0,h.observer)((function(e){let{model:t,handleClose:n}=e;const{classes:r}=q(),h=(0,C.getSession)(t),[A,k]=(0,o.useState)(),[x,N]=(0,o.useState)(),[R,F]=(0,o.useState)(!1),[O,U]=(0,o.useState)(!1),[I,M]=(0,o.useState)(!1),{leftOffset:j,rightOffset:z}=t,L=Boolean(void 0===x);(0,o.useEffect)((()=>{let e=!0;const n=new AbortController;return(async()=>{try{const o=t.getSelectedRegions(j,z);if(0===o.length)throw new Error("Selected region is out of bounds");const r=await async function(e,t,n){const o=(0,C.getSession)(e),{leftOffset:r,rightOffset:a}=e;if(!r||!a)throw new Error("no offsets on model to use for range");if(r.assemblyName!==a.assemblyName)throw new Error("not able to fetch sequences from multiple assemblies");const{rpcManager:l,assemblyManager:s}=o,c=r.assemblyName||a.assemblyName||"",i=s.get(c);if(!i)throw new Error("assembly ".concat(c," not found"));const u=(0,p.getConf)(i,["sequence","adapter"]),m="getSequence";return l.call(m,"CoreGetFeatures",{adapterConfig:u,regions:t,sessionId:m,signal:n})}(t,o,n.signal);e&&N(r)}catch(o){console.error(o),e&&k(o)}})(),()=>{n.abort(),e=!1}}),[t,h,j,z]);const T=x?(0,w.UU)(x.filter((e=>!!e)).map((e=>{let t=e.get("seq");const n=e.get("refName"),o=e.get("start")+1,r=e.get("end"),a="".concat(n,":").concat(o,"-").concat(r);if((null===t||void 0===t?void 0:t.length)!==r-o+1)throw new Error("".concat(a," returned ").concat(t.length.toLocaleString()," bases, but should have returned ").concat((r-o).toLocaleString()));return R&&(t=(0,C.reverse)(t)),I&&(t=(0,C.complement)(t)),{header:a+(R?"-rev":"")+(I?"-comp":""),seq:t}}))):"",B=!!T&&T.length>1e6;return o.createElement(v.Dialog,{maxWidth:"xl",open:!0,onClose:()=>{n(),t.setOffsets()},title:"Reference sequence"},o.createElement(a.A,null,A?o.createElement(l.A,{color:"error"},"".concat(A)):L?o.createElement(s.A,null,"Retrieving reference sequence...",o.createElement(c.A,{style:{marginLeft:10},size:20,disableShrink:!0})):null,o.createElement(i.A,{"data-testid":"rubberband-sequence",variant:"outlined",multiline:!0,minRows:5,maxRows:10,disabled:B,className:r.dialogContent,fullWidth:!0,value:B?"Reference sequence too large to display, use the download FASTA button":T,InputProps:{readOnly:!0,classes:{input:r.textAreaFont}}}),o.createElement(u.A,null,o.createElement(m.A,{control:o.createElement(d.A,{value:R,onChange:e=>F(e.target.checked)}),label:"Reverse sequence"}),o.createElement(m.A,{control:o.createElement(d.A,{value:I,onChange:e=>M(e.target.checked)}),label:"Complement sequence"})),o.createElement(l.A,{style:{margin:10}},'Note: Check both boxes for the "reverse complement"')),o.createElement(f.A,null,o.createElement(g.A,{onClick:()=>{E()(T),U(!0),setTimeout((()=>U(!1)),500)},disabled:L||!!A||B,color:"primary",startIcon:o.createElement(y.ContentCopy,null)},O?"Copied":"Copy to clipboard"),o.createElement(g.A,{onClick:()=>{(0,b.saveAs)(new Blob([T||""],{type:"text/x-fasta;charset=utf-8"}),"jbrowse_ref_seq.fa")},disabled:L||!!A,color:"primary",startIcon:o.createElement(S.A,null)},"Download FASTA"),o.createElement(g.A,{onClick:n,variant:"contained"},"Close")))}))},95971:(e,t,n)=>{var o=n(24994);t.A=void 0;var r=o(n(40039)),a=n(70579);t.A=(0,r.default)((0,a.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"GetApp")}}]);
//# sourceMappingURL=8068.10fd9d50.chunk.js.map