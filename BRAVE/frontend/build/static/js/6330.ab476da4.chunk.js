"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6330,216],{46330:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var l=n(65043),r=n(96233),a=n(95629),o=n(91775),i=n(70276),c=n(27616),s=n(71716),m=n(63026),d=n.n(m),u=n(57943),g=n(35624),h=n(57770),E=n(41453),p=n(33531),f=n(17555),v=n(14545),b=n(98082),k=n(53223),y=n(50216);const A=(0,i.makeStyles)()((e=>({controls:{position:"absolute",borderRight:"1px solid ".concat(e.palette.divider),borderBottom:"1px solid ".concat(e.palette.divider),left:0,top:0}}))),x=(0,r.observer)((function(e){let{model:t}=e;const{classes:n}=A(),[r,a]=(0,l.useState)(null);return l.createElement("div",{className:n.controls},l.createElement(s.A,{onClick:t.zoomOutButton,title:t.lockedFitToWindow?"unlock to zoom out":"zoom out",disabled:t.atMaxBpPerPx||t.lockedFitToWindow},l.createElement(u.A,null)),l.createElement(s.A,{onClick:t.zoomInButton,disabled:t.atMinBpPerPx,title:"zoom in"},l.createElement(g.A,null)),l.createElement(s.A,{onClick:t.rotateCounterClockwiseButton,title:"rotate counter-clockwise"},l.createElement(h.A,null)),l.createElement(s.A,{onClick:t.rotateClockwiseButton,title:"rotate clockwise"},l.createElement(E.A,null)),l.createElement(s.A,{onClick:t.toggleFitToWindowLock,title:t.lockedFitToWindow?"locked model to window size":"unlocked model to zoom further",disabled:t.tooSmallToLock},t.lockedFitToWindow?l.createElement(f.A,null):l.createElement(p.A,null)),l.createElement(s.A,{onClick:e=>a(e.currentTarget)},l.createElement(b.A,null)),t.hideTrackSelectorButton?null:l.createElement(s.A,{onClick:t.activateTrackSelector,title:"Open track selector","data-testid":"circular_track_select"},l.createElement(k.TrackSelector,null)),r?l.createElement(d(),{anchorEl:r,menuItems:[{label:"Export SVG",icon:v.A,onClick:()=>{(0,o.getSession)(t).queueDialog((e=>[y.default,{model:t,handleClose:e}]))}}],onMenuItemClick:(e,t)=>{t(),a(null)},open:Boolean(r),onClose:()=>a(null)}):null)}));var C=n(19252),S=n(8591),w=n(72882);const T=(0,i.makeStyles)()((e=>({importFormContainer:{padding:e.spacing(6)}}))),z=(0,r.observer)((e=>{let{model:t}=e;const{classes:n}=T(),r=(0,o.getSession)(t),{error:i}=t,{assemblyNames:c,assemblyManager:s}=r,[m,d]=(0,l.useState)(c[0]),u=s.get(m),g=c.length?null===u||void 0===u?void 0:u.error:"No configured assemblies",h=(null===u||void 0===u?void 0:u.regions)||[],E=g||i;return l.createElement(C.A,{className:n.importFormContainer},E?l.createElement(S.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},l.createElement(S.Ay,{item:!0},l.createElement(a.ErrorMessage,{error:E}))):null,l.createElement(S.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},l.createElement(S.Ay,{item:!0},l.createElement(a.AssemblySelector,{onChange:e=>{t.setError(void 0),d(e)},session:r,selected:m})),l.createElement(S.Ay,{item:!0},l.createElement(w.A,{disabled:!(null===h||void 0===h?void 0:h.length),onClick:()=>{t.setError(void 0),t.setDisplayedRegions(h)},variant:"contained",color:"primary"},h.length||E?"Open":"Loading..."))))})),M=(0,i.makeStyles)()((e=>({root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},scroller:{overflow:"auto"}}))),R=(0,r.observer)((e=>{let{model:t}=e;return l.createElement(l.Fragment,null,t.staticSlices.map((e=>l.createElement(c.A,{key:(0,o.assembleLocString)(e.region.elided?e.region.regions[0]:e.region),model:t,slice:e}))),t.tracks.map((e=>{const n=e.displays[0];return l.createElement(n.RenderingComponent,{key:n.id,display:n,view:t})})))})),L=(0,r.observer)((e=>{let{model:t}=e;const n=!!t.displayedRegions.length&&!!t.figureWidth&&!!t.figureHeight&&t.initialized,r=!n&&!t.disableImportForm,a=n&&!r;return l.createElement(l.Fragment,null,r||t.error?l.createElement(z,{model:t}):a?l.createElement(N,{model:t}):null)})),N=(0,r.observer)((function(e){let{model:t}=e;const{width:n,height:r,id:o,offsetRadians:i,centerXY:c,figureWidth:s,figureHeight:m,hideVerticalResizeHandle:d}=t,{classes:u}=M();return l.createElement("div",{className:u.root,style:{width:n,height:r},"data-testid":o},l.createElement("div",{className:u.scroller,style:{width:n,height:r}},l.createElement("svg",{style:{transform:"rotate(".concat(i,"rad)"),transition:"transform 0.5s",transformOrigin:c.map((e=>"".concat(e,"px"))).join(" "),position:"absolute",left:0,top:0},width:s,height:m},l.createElement("g",{transform:"translate(".concat(c,")")},l.createElement(R,{model:t})))),l.createElement(x,{model:t}),d?null:l.createElement(a.ResizeHandle,{onDrag:t.resizeHeight,style:{height:3,position:"absolute",bottom:0,left:0,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}}))})),P=L},50216:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var l=n(65043),r=n(97334),a=n(94496),o=n(97368),i=n(42788),c=n(94814),s=n(99784),m=n(1273),d=n(92064),u=n(72882),g=n(95629),h=n(91775);function E(){return l.createElement("div",null,l.createElement(r.A,{size:20,style:{marginRight:20}}),l.createElement(a.A,{display:"inline"},"Creating SVG"))}function p(e,t){return(0,h.useLocalStorage)("svg-"+e,t)}function f(e){let{model:t,handleClose:n}=e;const r=(0,h.getSession)(t),f="undefined"!==typeof OffscreenCanvas,[v,b]=(0,l.useState)(f),[k,y]=(0,l.useState)(!1),[A,x]=(0,l.useState)(),[C,S]=p("file","jbrowse.svg"),[w,T]=p("theme",r.themeName||"default");return l.createElement(g.Dialog,{open:!0,onClose:n,title:"Export SVG"},l.createElement(o.A,null,A?l.createElement(g.ErrorMessage,{error:A}):k?l.createElement(E,null):null,l.createElement(i.A,{helperText:"filename",value:C,onChange:e=>S(e.target.value)}),l.createElement("br",null),r.allThemes?l.createElement(i.A,{select:!0,label:"Theme",value:w,onChange:e=>T(e.target.value)},Object.entries(r.allThemes()).map((e=>{let[t,n]=e;return l.createElement(c.A,{key:t,value:t},n.name||"(Unknown name)")}))):null,f?l.createElement(s.A,{control:l.createElement(m.A,{checked:v,onChange:()=>b((e=>!e))}),label:"Rasterize canvas based tracks? File may be much larger if this is turned off"}):l.createElement(a.A,null,"Note: rasterizing layers not yet supported in this browser, so SVG size may be large")),l.createElement(d.A,null,l.createElement(u.A,{variant:"contained",color:"secondary",onClick:()=>n()},"Cancel"),l.createElement(u.A,{variant:"contained",color:"primary",type:"submit",onClick:async()=>{y(!0),x(void 0);try{await t.exportSvg({rasterizeLayers:v,filename:C,themeName:w}),n()}catch(e){console.error(e),x(e),y(!1)}}},"Submit")))}},27616:(e,t,n)=>{n.d(t,{A:()=>g});var l=n(65043),r=n(96233),a=n(91775),o=n(78791),i=n(26240);const c=(0,n(70276).makeStyles)()({rulerLabel:{fontSize:"0.8rem",fontWeight:500,lineHeight:1.6,letterSpacing:"0.0075em"}});function s(e,t,n,l){e.flipped&&([n,l]=[l,n]);const r=e.bpToXY(n,t),a=e.bpToXY(l,t);return["M",...r,"A",t,t,"0",Math.abs(l-n)/e.bpPerRadian>Math.PI?"1":"0","1",...a].join(" ")}const m=(0,r.observer)((function(e){let{model:t,slice:n,region:r}=e;const o=(0,i.A)(),{radiusPx:c}=t,s=c+1,{endRadians:m,startRadians:u}=n,g=(0,a.polarToCartesian)(s,u),h=(0,a.polarToCartesian)(s,m),E=(m-u)*s,p=m-u>Math.PI?"1":"0",f=(m+u)/2,v="[".concat(Number(r.regions.length).toLocaleString(),"]");return l.createElement(l.Fragment,null,l.createElement(d,{text:v,view:t,maxWidthPx:E,radians:f,radiusPx:s,title:"".concat(v," more regions"),color:o.palette.text.primary}),l.createElement("path",{d:["M",...g,"A",s,s,"0",p,"1",...h].join(" "),stroke:o.palette.text.secondary,strokeWidth:2,strokeDasharray:"2,2",fill:"none"}))})),d=(0,r.observer)((function(e){let{view:t,text:n,maxWidthPx:r,radians:o,radiusPx:i,title:s,color:m}=e;const{classes:d}=c(),u=(0,a.polarToCartesian)(i+5,o);if(!n)return null;if(6.5*n.length<r)return l.createElement("text",{x:0,y:0,className:d.rulerLabel,textAnchor:"middle",dominantBaseline:"baseline",transform:"translate(".concat(u,") rotate(").concat((0,a.radToDeg)(o)+90,")"),style:{fill:m}},n,l.createElement("title",null,s||n));if(r>4){return(0,a.radToDeg)(o+t.offsetRadians-Math.PI/2)>=180?l.createElement("text",{x:0,y:0,className:d.rulerLabel,textAnchor:"start",dominantBaseline:"middle",transform:"translate(".concat(u,") rotate(").concat((0,a.radToDeg)(o),")"),style:{fill:m}},n,l.createElement("title",null,s||n)):l.createElement("text",{x:0,y:0,className:d.rulerLabel,textAnchor:"end",dominantBaseline:"middle",transform:"translate(".concat(u,") rotate(").concat((0,a.radToDeg)(o)+180,")"),style:{fill:m}},n,l.createElement("title",null,s||n))}return null})),u=(0,r.observer)((function(e){let{model:t,slice:n,region:r}=e;const c=(0,i.A)(),{radiusPx:m}=t,{endRadians:u,startRadians:g}=n,h=(u+g)/2,E=(u-g)*m;let p;const f=(0,a.getSession)(t).assemblyManager.get(r.assemblyName);if(f&&(p=f.getRefNameColor(r.refName)),p)try{p=(0,o.makeContrasting)(p,c.palette.background.paper)}catch(v){p=c.palette.text.primary}else p=c.palette.text.primary;return l.createElement(l.Fragment,null,l.createElement(d,{text:r.refName,view:t,maxWidthPx:E,radians:h,radiusPx:m,color:p}),l.createElement("path",{d:s(n,m+1,r.start,r.end),stroke:p,strokeWidth:2,fill:"none"}))})),g=(0,r.observer)((function(e){let{model:t,slice:n}=e;return n.region.elided?l.createElement(m,{key:(0,a.assembleLocString)(n.region.regions[0]),model:t,region:n.region,slice:n}):l.createElement(u,{key:(0,a.assembleLocString)(n.region),region:n.region,model:t,slice:n})}))},17555:(e,t,n)=>{var l=n(24994);t.A=void 0;var r=l(n(40039)),a=n(70579);t.A=(0,r.default)((0,a.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1z"}),"Lock")},33531:(e,t,n)=>{var l=n(24994);t.A=void 0;var r=l(n(40039)),a=n(70579);t.A=(0,r.default)((0,a.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen")},57770:(e,t,n)=>{var l=n(24994);t.A=void 0;var r=l(n(40039)),a=n(70579);t.A=(0,r.default)((0,a.jsx)("path",{d:"M7.11 8.53 5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47M6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47m1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93"}),"RotateLeft")},41453:(e,t,n)=>{var l=n(24994);t.A=void 0;var r=l(n(40039)),a=n(70579);t.A=(0,r.default)((0,a.jsx)("path",{d:"M15.55 5.55 11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03m3.89-2.42 1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48"}),"RotateRight")}}]);
//# sourceMappingURL=6330.ab476da4.chunk.js.map