"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1786],{61786:(n,e,a)=>{a.d(e,{doConnect:()=>v});class t{constructor(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;this.data={};const{checkIndent:a=!0,skipValidation:t=!1}=null!==e&&void 0!==e?e:{};let r,o,i;r="string"===typeof n?n.trimEnd().split(/\r?\n/):n||[];for(const c of r){if(""===c)throw new Error("Invalid stanza, contained blank lines");if(c.trim().startsWith("#"))continue;if(c.trimEnd().endsWith("\\")){const n=c.trimEnd().slice(0,-1);i?i+=n.trimStart():i=n;continue}let n=c;if(i&&(n=i+n.trimStart(),i=void 0),null!==o&&void 0!==o?o:a){const e=n.match(/^([ \t]+)/);if(void 0===o)e?[,o]=e:o="";else if(""===o&&null!==e||o&&e&&o!==e[1])throw new Error("Inconsistent indentation of stanza")}else o="";const e=n.trim(),t=e.indexOf(" ");if(-1===t){if(!this.nameKey)throw new Error("First line in a stanza must have both a key and a value");if(this.data[e])continue;this.data[e]="";continue}const r=e.slice(0,t),s=e.slice(t+1);if(this.data[r]&&s!==this.data[r])throw new Error("Got duplicate key with a different value in stanza: "+'"'.concat(r,'" key has both ').concat(this.data[r]," and ").concat(s));this.nameKey||(this.nameKey=r,this.name=e.slice(t+1)),this.data[r]=s}t||this.validate()}validate(){}}class r{constructor(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;this.data={};const{checkIndent:a=!0,skipValidation:r=!1}=null!==e&&void 0!==e?e:{};let o;o="string"===typeof n?n.trimEnd().split(/(?:[\t ]*\r?\n){2,}/):n||[];for(const i of o){if(""===i)throw new Error("Invalid stanza, was empty");if(i.trim().startsWith("#")){if(i.trimEnd().split(/\r?\n/).map((n=>n.trim())).every((n=>n.startsWith("#"))))continue}const n=new t(i,{checkIndent:a});if(this.nameKey){if(n.nameKey!==this.nameKey)throw new Error("The first line in each stanza must have the same key. "+"Saw both ".concat(this.nameKey," and ").concat(n.nameKey))}else this.nameKey=n.nameKey;if(!n.name)throw new Error("No stanza name: ".concat(n.name));if(this.data[n.name])throw new Error("Got duplicate stanza name: ".concat(n.name));this.data[n.name]=n}r||this.validate()}validate(){}}function o(n,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const t=[];for(const r of e)n.data[r]||t.push(r);if(t.length>0)throw new Error("".concat(a," is missing required entr").concat(1===t.length?"y":"ies",": ").concat(t.join(", ")))}class i extends r{constructor(n,e){super(n,{...e,checkIndent:!1})}validate(){var n;if("track"!==this.nameKey)throw new Error('trackDb has "'.concat(this.nameKey,'" instead of "track" as the first line in each track'));for(const[e,a]of Object.entries(this.data)){const t=Object.keys(a.data);o(a,["track","shortLabel"],"Track ".concat(e));const r=new Set(["superTrack","compositeTrack","container","view"]);if(!t.some((n=>r.has(n)))){if(!t.includes("bigDataUrl"))throw new Error("Track ".concat(e,' is missing required key "bigDataUrl"'));if(!t.includes("type")){if(!Object.keys(this.settings(e)).includes("type"))throw new Error("Neither track ".concat(e,' nor any of its parent tracks have the required key "type"'))}}let i=e;do{i=null===(n=this.data[i])||void 0===n?void 0:n.parent,i&&([i]=i.split(" "))}while(i);const c=this.data[e];c&&(this.data[e]=c)}}settings(n){var e;if(!this.data[n])throw new Error("Track ".concat(n," does not exist"));const a=[n];let t=n;do{t=null===(e=this.data[t])||void 0===e?void 0:e.parent,t&&a.push(t)}while(t);const r={};a.reverse();for(const o of a){const n=this.data[o];if(n)for(const[e,a]of Object.entries(n))r[e]=a}return r}}class c extends r{validate(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["genome","trackDb"];if("genome"!==this.nameKey)throw new Error('Genomes file must begin with a line like "genome <genome_name>"');for(const[e,a]of Object.entries(this.data))o(a,n,"genome ".concat(e))}}class s extends t{validate(){o(this,["hub","shortLabel","longLabel","genomesFile","email"],"Hub file")}}class l{constructor(n){const[e,a,...r]=n.trimEnd().split(/(?:[\t ]*\r?\n){2,}/);this.hubData=new t(e),this.validateHub(),this.genome=new t(a),this.validateGenomeSection(),this.tracks=new i(r.join("\n\n"),{skipValidation:!1})}validateHub(){if("hub"!==this.hubData.nameKey)throw new Error('Hub file must begin with a line like "hub <hub_name>"');o(this.hubData,["hub","shortLabel","longLabel","email","descriptionUrl"])}validateGenomeSection(){if("genome"!==this.genome.nameKey)throw new Error('Genomes file must begin with a line like "genome <genome_name>"')}}var d=a(91775),h=a(50472),u=a(19871);"ailMel1\nallMis1\nanoCar1\nanoCar2\nanoGam1\nanoGam3\napiMel1\napiMel2\naplCal1\naptMan1\naquChr2\nbalAcu1\nbisBis1\nbosTau2\nbosTau3\nbosTau4\nbosTau6\nbosTau7\nbosTau8\nbraFlo1\ncaeJap1\ncaePb1\ncaePb2\ncaeRem2\ncaeRem3\ncalJac1\ncalJac3\ncalMil1\ncanFam1\ncanFam3\ncavPor3\ncb3\nce10\nce11\nce2\nce4\nce6\ncerSim1\nchlSab2\nchoHof1\nchrPic1\nci1\nci2\nci3\ncriGri1\ncriGriChoV1\ndanRer10\ndanRer11\ndanRer3\ndanRer4\ndanRer5\ndanRer6\ndanRer7\ndasNov3\ndipOrd1\ndm1\ndm2\ndm3\ndm6\ndp2\ndp3\ndroAna1\ndroAna2\ndroEre1\ndroGri1\ndroMoj1\ndroMoj2\ndroPer1\ndroSec1\ndroSim1\ndroVir1\ndroVir2\ndroYak1\ndroYak2\neboVir3\nechTel1\nechTel2\nequCab1\nequCab2\neriEur1\neriEur2\nfelCat3\nfelCat4\nfelCat5\nfelCat8\nfr1\nfr2\nfr3\ngadMor1\ngalGal2\ngalGal3\ngalGal4\ngalGal5\ngalGal6\ngalVar1\ngasAcu1\ngeoFor1\ngorGor3\ngorGor4\ngorGor5\nhetGla1\nhetGla2\nhg16\nhg18\nhg19\nhg38\nlatCha1\nloxAfr3\nmacEug2\nmacFas5\nmanPen1\nmelGal1\nmelGal5\nmelUnd1\nmicMur1\nmicMur2\nmm10\nmm7\nmm8\nmm9\nmonDom2\nmonDom4\nmonDom5\nmusFur1\nmyoLuc2\nnanPar1\nnasLar1\nnomLeu1\nnomLeu2\nnomLeu3\nochPri2\nochPri3\noreNil2\nornAna1\nornAna2\noryCun2\noryLat2\notoGar3\noviAri1\noviAri3\noviAri4\npanPan1\npanPan2\npanTro1\npanTro2\npanTro3\npanTro4\npanTro5\npanTro6\npapAnu2\npapHam1\npetMar1\npetMar2\nponAbe2\nponAbe3\npriPac1\nproCap1\npteVam1\nrheMac2\nrheMac3\nrheMac8\nrhiRox1\nrn4\nrn5\nrn6\nsacCer1\nsacCer2\nsacCer3\nsaiBol1\nsarHar1\nsorAra1\nsorAra2\nspeTri2\nstrPur1\nstrPur2\nsusScr11\nsusScr2\nsusScr3\ntaeGut1\ntaeGut2\ntarSyr1\ntarSyr2\ntetNig1\ntetNig2\nthaSir1\ntriMan1\ntupBel1\nturTru2\nventer1\nvicPac1\nvicPac2\nxenLae2\nxenTro1\nxenTro2\nxenTro3\nxenTro7\nxenTro9".split(/\r?\n/);async function m(n){const e=await(0,h.openLocation)(n).readFile("utf8");return new i(e)}function p(n,e){return{uri:new URL(n,new URL(e.uri,e.baseUri)).href,locationType:"UriLocation"}}function b(n,e,a){return p(n||e,a)}function f(n,e){return n?{uri:n,locationType:"LocalPath"}:{uri:e,locationType:"UriLocation"}}function g(n){let{trackDb:e,trackDbLoc:a,assemblyName:t,sequenceAdapter:r}=n;return Object.entries(e.data).map((n=>{let[o,i]=n;var c;const s=Object.keys(i),l=new Set(["superTrack","compositeTrack","container","view"]);if(s.some((n=>l.has(n))))return;const h=[];let m=o;do{m=(null===(c=e.data[m])||void 0===c?void 0:c.data.parent)||"",m&&([m]=m.split(" "),h.push(e.data[m]))}while(m);h.reverse();const g=function(n){let{track:e,categories:a,trackDbLoc:t,trackDb:r,sequenceAdapter:o}=n;var i;const c=e.data.type||(null===(i=r.data[e.data.parent||""])||void 0===i?void 0:i.data.type)||"",s=e.data.shortLabel||"",l=e.data.bigDataUrl||"",h=e.data.bigDataIndex||"",m=(0,d.isUriLocation)(t);let g=(null===c||void 0===c?void 0:c.split(" ")[0])||"";"bam"===g&&l.toLowerCase().endsWith("cram")&&(g="cram");const y=m?p(l,t):f(l);switch(g){case"bam":return{type:"AlignmentsTrack",name:e.data.longLabel,description:e.data.longLabel,category:a,adapter:{type:"BamAdapter",bamLocation:y,index:{location:m?b(h,l+".bai",t):f(h,l+".bai")}}};case"cram":return{type:"AlignmentsTrack",name:s,description:e.data.longLabel,category:a,adapter:{type:"CramAdapter",cramLocation:y,craiLocation:m?b(h,l+".crai",t):f(h,l+".crai"),sequenceAdapter:o}};case"bigBarChart":case"bigBed":case"bigGenePred":case"bigChain":case"bigInteract":case"bigMaf":case"bigNarrowPeak":case"bigPsl":return{type:"FeatureTrack",name:s,description:e.data.longLabel,category:a,adapter:{type:"BigBedAdapter",bigBedLocation:y}};case"bigWig":return{type:"QuantitativeTrack",name:s,description:e.data.longLabel,category:a,adapter:{type:"BigWigAdapter",bigWigLocation:y}};case"vcfTabix":return{type:"VariantTrack",name:s,description:e.data.longLabel,category:a,adapter:{type:"VcfTabixAdapter",vcfGzLocation:y,index:{location:m?b(h,l+".tbi",t):f(h,l+".tbi")}}};case"hic":return{type:"HicTrack",name:s,description:e.data.longLabel,category:a,adapter:{type:"HicAdapter",hicLocation:y}};default:return(0,u.generateUnknownTrackConf)(s,g,a)}}({track:i,categories:h.map((n=>null===n||void 0===n?void 0:n.data.shortLabel)).filter((n=>!!n)),trackDbLoc:a,trackDb:e,sequenceAdapter:r});return{...g,trackId:"ucsc-trackhub-".concat((0,d.objectHash)(g)),assemblyNames:[t]}})).filter(d.notEmpty)}var y=a(98779),w=a(38956);function k(n,e){return new URL(n,e).href}async function v(n){var e;const a=(0,d.getSession)(n),t=[];try{const e=(0,y.getConf)(n,"hubTxtLocation"),r=await(0,h.openLocation)(e).readFile("utf8"),o=k(e.uri,e.baseUri),{assemblyManager:i}=a;if(r.includes("useOneFile on")){const t=new l(r),{genome:c,tracks:s}=t,d=c.name;i.get(d)||a.addSessionAssembly({name:d,sequence:{type:"ReferenceSequenceTrack",trackId:"".concat(d,"-").concat((0,w.nanoid)()),adapter:{type:"TwoBitAdapter",twoBitLocation:{uri:k(c.data.twoBitPath,o)},chromSizesLocation:{uri:k(c.data.chromSizes,o)}}}});const h=i.get(d),u=g({trackDb:s,trackDbLoc:e,assemblyName:d,sequenceAdapter:(0,y.getConf)(h,["sequence","adapter"])});n.addTrackConfs(u)}else{const o=new s(r).data.genomesFile;if(!o)throw new Error("genomesFile not found on hub");const l=k(e.uri,e.baseUri),d=l?{uri:k(o,l),locationType:"UriLocation"}:{localPath:o,locationType:"LocalPathLocation"},u=await async function(n){const e=await(0,h.openLocation)(n).readFile("utf8");return new c(e)}(d),p={};for(const[e,a]of Object.entries(u.data)){const r=(0,y.getConf)(n,"assemblyNames");if(r.length>0&&!r.includes(e))continue;const c=i.get(e);if(!c){t.push(e);continue}const s=a.data.trackDb;if(!s)throw new Error("genomesFile not found on hub");const d=new URL(o,l),h=l?{uri:new URL(s,d).href,locationType:"UriLocation"}:{localPath:s,locationType:"LocalPathLocation"},u=await m(h),b=g({trackDb:u,trackDbLoc:h,assemblyName:e,sequenceAdapter:(0,y.getConf)(c,["sequence","adapter"])});n.addTrackConfs(b),p[e]=b.length}const b=Object.entries(p),f=b.length?"Loaded data from these assemblies: ".concat(b.map((n=>{let[e,a]=n;return"".concat(e," (").concat(a," tracks)")})).join(", ")):"",w=t.length?"Skipped data from these assemblies: ".concat(t.join(", ")):"";a.notify([f,w].filter((n=>!!n)).join(". "),"success")}}catch(r){console.error(r),a.notify("".concat((0,y.getConf)(n,"name"),': "').concat(r,'"'),"error"),null===(e=a.breakConnection)||void 0===e||e.call(a,n.configuration)}}}}]);
//# sourceMappingURL=1786.85a2e18b.chunk.js.map