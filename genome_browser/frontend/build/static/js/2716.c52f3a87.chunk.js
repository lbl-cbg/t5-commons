"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2716],{12716:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ee});var n=a(65043),r=a(96233),l=a(78632),s=a(17434),c=a(94814),o=a(66124),i=a(91775),d=a(94496),m=a(3352),p=a(52642),u=a(5568),g=a(61800),k=a(72882),f=a(71861),E=a(70276),h=a(31913),y=a(98779),v=a(91598),A=a(42788),b=a(99784),S=a(1273),N=a(19871),T=a(95629),x=a(65204),w=a(17642),C=a(59314),D=a(98056),I=a(71062),M=a(80216),P=a(56894),W=a(71716),O=a(63471),B=a(22505);const j=(0,E.makeStyles)()((e=>({paper:{display:"flex",flexDirection:"column",padding:e.spacing(1)},card:{marginTop:e.spacing(1)}}))),U=(0,r.observer)((function(e){let{model:t}=e;const{classes:a}=j(),[r,l]=(0,n.useState)(""),[s,c]=(0,n.useState)(""),[o,i]=(0,n.useState)(["Name","ID"]),[d,m]=(0,n.useState)(["CDS","exon"]),p=[{label:"Indexing attributes",values:o},{label:"Feature types to exclude",values:d}];return(0,n.useEffect)((()=>{t.setTextIndexingConf({attributes:o,exclude:d})}),[t,o,d]),n.createElement(x.A,{className:a.paper},n.createElement(w.A,null,"Indexing configuration"),p.map(((e,t)=>n.createElement(C.A,{raised:!0,key:e.label,className:a.card},n.createElement(D.A,null,n.createElement(w.A,null,e.label),n.createElement(I.A,{disablePadding:!0},e.values.map(((a,r)=>n.createElement(M.Ay,{key:r,disableGutters:!0},n.createElement(A.A,{value:a,InputProps:{endAdornment:n.createElement(P.A,{position:"end"},n.createElement(W.A,{onClick:()=>{const a=e.values.filter(((e,t)=>t!==r));0===t?i(a):m(a)}},n.createElement(O.A,null)))}})))),n.createElement(M.Ay,{disableGutters:!0},n.createElement(A.A,{value:0===t?r:s,placeholder:"add new",onChange:e=>{0===t?l(e.target.value):c(e.target.value)},InputProps:{endAdornment:n.createElement(P.A,{position:"end"},n.createElement(W.A,{onClick:()=>{0===t?(i([...o,r]),l("")):(m([...d,s]),c(""))},disabled:0===t?""===r:""===s,"data-testid":"stringArrayAdd-Feat"},n.createElement(B.A,null)))}}))))))))})),F=(0,E.makeStyles)()((e=>({spacing:{marginBottom:e.spacing(3)}}))),J=(0,r.observer)((e=>{let{model:t}=e;const{classes:a}=F(),{pluginManager:r}=(0,i.getEnv)(t),{trackType:l}=t,s=r.getTrackElements();return n.createElement(A.A,{className:a.spacing,value:l,variant:"outlined",label:"Track type",helperText:"Select track type",select:!0,fullWidth:!0,onChange:e=>t.setTrackType(e.target.value),SelectProps:{SelectDisplayProps:{"data-testid":"trackTypeSelect"}}},s.map((e=>{let{name:t,displayName:a}=e;return n.createElement(c.A,{key:t,value:t},a)})))}));var G=a(67080);const R=(0,E.makeStyles)()((e=>({spacing:{marginBottom:e.spacing(3)}})));const q=(0,r.observer)((e=>{let{model:t}=e;const{classes:a}=R(),{trackAdapter:r}=t,{pluginManager:l}=(0,i.getEnv)(t);return n.createElement(A.A,{className:a.spacing,value:"UNKNOWN"!==(null===r||void 0===r?void 0:r.type)?null===r||void 0===r?void 0:r.type:"",label:"Adapter type",variant:"outlined",helperText:"Select an adapter type",select:!0,fullWidth:!0,onChange:e=>t.setAdapterHint(e.target.value),SelectProps:{SelectDisplayProps:{"data-testid":"adapterTypeSelect"}}},Object.entries(function(e){const t={};return e.forEach((e=>{var a;const n=(null===(a=e.adapterMetadata)||void 0===a?void 0:a.category)||"Default";t[n]||(t[n]=[]),t[n].push(e)})),t}(l.getAdapterElements().filter((e=>{var t;return!(null===(t=e.adapterMetadata)||void 0===t?void 0:t.hiddenFromGUI)})))).map((e=>{let[t,a]=e;return[n.createElement(G.A,{key:t},t),a.map((e=>n.createElement(c.A,{key:e.name,value:e.name},e.displayName)))]})))})),H=(0,E.makeStyles)()((e=>({spacing:{marginBottom:e.spacing(3)}})));function L(e){let{trackAdapter:t,trackType:a}=e;const{classes:r}=H(),{type:l,subadapter:s}=t;return"SNPCoverageAdapter"===l?n.createElement(d.A,{className:r.spacing},"Selected ",n.createElement("code",null,a),". Using adapter ",n.createElement("code",null,l)," with subadapter ",n.createElement("code",null,null===s||void 0===s?void 0:s.type),". Please enter a track name and, if necessary, update the track type."):n.createElement(d.A,{className:r.spacing},"Using adapter ",n.createElement("code",null,l)," and guessing track type"," ",n.createElement("code",null,a),". Please enter a track name and, if necessary, update the track type.")}function _(e){let{model:t}=e;const{classes:a}=H();return n.createElement(n.Fragment,null,n.createElement(d.A,{className:a.spacing},"JBrowse was not able to guess the adapter type for this data, but it may be in the list below. If not, you can"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse to see if they support this data type or"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type."),n.createElement(q,{model:t}))}const z=(0,r.observer)((function(e){let{model:t}=e;const{classes:a}=H(),[r,s]=(0,n.useState)(!0),c=(0,i.getSession)(t),{trackName:o,trackAdapter:m,trackType:p,warningMessage:u,adapterHint:g}=t;if((0,n.useEffect)((()=>{""===g&&m&&t.setAdapterHint(m.type)}),[g,m,null===m||void 0===m?void 0:m.type,t]),t.unsupported)return n.createElement(d.A,{className:a.spacing},"This version of JBrowse cannot display data of this type. It is possible, however, that there is a newer version that can display them. You can"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse or"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type.");if((null===m||void 0===m?void 0:m.type)===N.UNKNOWN)return n.createElement(_,{model:t});if(!(null===m||void 0===m?void 0:m.type))return n.createElement(d.A,null,"Could not recognize this data type.");const k=(0,i.isSupportedIndexingAdapter)(null===m||void 0===m?void 0:m.type);return n.createElement("div",null,m?n.createElement(L,{trackAdapter:m,trackType:p}):null,u?n.createElement(d.A,{style:{color:"orange"}},u):null,n.createElement(A.A,{className:a.spacing,label:"trackName",helperText:"A name for this track",fullWidth:!0,value:o,onChange:e=>t.setTrackName(e.target.value),inputProps:{"data-testid":"trackNameInput"}}),n.createElement(q,{model:t}),n.createElement(J,{model:t}),n.createElement(T.AssemblySelector,{session:c,helperText:"Select assembly to add track to",selected:t.assembly,onChange:e=>t.setAssembly(e),TextFieldProps:{fullWidth:!0,SelectProps:{SelectDisplayProps:{"data-testid":"assemblyNameSelect"}}}}),i.isElectron&&k&&n.createElement(l.A,null,n.createElement(b.A,{label:"Index track for text searching?",control:n.createElement(S.A,{checked:r,onChange:e=>{s(e.target.checked),t.setTextIndexTrack(e.target.checked)}})})),i.isElectron&&r&&k?n.createElement(U,{model:t}):null)})),K=(0,E.makeStyles)()((e=>({paper:{padding:e.spacing(2)},spacer:{height:e.spacing(8)}}))),V=(0,r.observer)((function(e){let{model:t}=e;const{classes:a}=K(),r=(0,h.getRoot)(t);return n.createElement(x.A,{className:a.paper},n.createElement(T.FileSelector,{name:"Main file",description:"",location:t.trackData,setLocation:t.setTrackData,setName:t.setTrackName,rootModel:r}),n.createElement("div",{className:a.spacer}),n.createElement(T.FileSelector,{name:"Index file",description:"(Optional) The URL of the index file is automatically inferred from the URL of the main file if it is not supplied.",location:t.indexTrackData,setLocation:t.setIndexTrackData,setName:t.setTrackName,rootModel:r}))})),Y=(0,E.makeStyles)()((e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginRight:e.spacing(1)},actionsContainer:{marginTop:e.spacing(10),marginBottom:e.spacing(2)},alertContainer:{padding:"".concat(e.spacing(2),"px 0px ").concat(e.spacing(2),"px 0px")}}))),Q=["Enter track data","Confirm track type"],X=(0,r.observer)((function(e){let{model:t}=e;const[a,r]=(0,n.useState)(0),{classes:l}=Y(),{jobsManager:s}=(0,h.getRoot)(t),c=(0,i.getSession)(t),{assembly:o,trackAdapter:E,trackData:v,trackName:A,trackType:b,textIndexTrack:S,textIndexingConf:N}=t,[T,x]=(0,n.useState)();async function w(){var e,n;if(a!==Q.length-1)return void r(a+1);const l=["".concat(A.toLowerCase().replaceAll(" ","_"),"-").concat(Date.now()),"".concat(c.adminMode?"":"-sessionTrack")].join(""),d=c.assemblyManager.get(o);if((0,i.isSessionWithAddTracks)(c))if(d&&E&&"UNKNOWN"!==E.type){if(c.addTrackConf({trackId:l,type:b,name:A,assemblyNames:[o],adapter:{...E,sequenceAdapter:(0,y.getConf)(d,["sequence","adapter"])}}),null===(n=(e=t.view).showTrack)||void 0===n||n.call(e,l),i.isElectron&&S&&(0,i.isSupportedIndexingAdapter)(E.type)){const e=A+"-index",t={indexingParams:{...N||{attributes:["Name","ID"],exclude:["CDS","exon"]},assemblies:[o],tracks:[l],indexType:"perTrack",name:e,timestamp:(new Date).toISOString()},name:e,cancelCallback:()=>s.abortJob()};s.queueJob(t)}t.clearData(),(0,i.isSessionModelWithWidgets)(c)&&c.hideWidget(t)}else x("Failed to add track.\nThe configuration of this file is not currently supported.");else x("Unable to add tracks to this model")}function C(){switch(a){case 0:return!v;case 1:return!(A&&b&&(null===E||void 0===E?void 0:E.type)&&o);default:return!0}}return n.createElement("div",{className:l.root},n.createElement(m.A,{className:l.stepper,activeStep:a,orientation:"vertical"},Q.map(((e,s)=>n.createElement(p.A,{key:e},n.createElement(u.A,null,e),n.createElement(g.A,null,function(e){switch(e){case 0:return n.createElement(V,{model:t});case 1:return n.createElement(z,{model:t});default:return n.createElement(d.A,null,"Unknown step")}}(s),n.createElement("div",{className:l.actionsContainer},n.createElement(k.A,{disabled:0===a,onClick:()=>{x(void 0),r(a-1)},className:l.button},"Back"),n.createElement(k.A,{disabled:C(),variant:"contained",color:"primary",onClick:w,className:l.button,"data-testid":"addTrackNextButton"},a===Q.length-1?"Add":"Next")),T?n.createElement("div",{className:l.alertContainer},n.createElement(f.A,{severity:"error"},T)):null))))))})),Z=(0,E.makeStyles)()({textbox:{width:"100%"},submit:{marginTop:25,marginBottom:100,display:"block"}}),$=(0,r.observer)((function(e){let{model:t}=e;const{classes:a}=Z(),[r,l]=(0,n.useState)(""),[s,c]=(0,n.useState)();return n.createElement("div",null,s?n.createElement(T.ErrorMessage,{error:s}):null,n.createElement(A.A,{multiline:!0,rows:10,value:r,onChange:e=>l(e.target.value),placeholder:"Paste track config or array of track configs in JSON format",variant:"outlined",className:a.textbox}),n.createElement(k.A,{variant:"contained",className:a.submit,onClick:()=>{try{c(void 0);const e=(0,i.getSession)(t),a=JSON.parse(r),n=Array.isArray(a)?a:[a];(0,i.isSessionWithAddTracks)(e)&&(0,i.isSessionModelWithWidgets)(e)&&(n.forEach((t=>e.addTrackConf(t))),n.forEach((e=>t.view.showTrack(e.trackId))),t.clearData(),e.hideWidget(t))}catch(e){console.error(e),c(e)}}},"Submit"))})),ee=(0,r.observer)((function(e){let{model:t}=e;const[a,r]=(0,n.useState)("Default add track workflow"),{pluginManager:d}=(0,i.getEnv)(t),m=d.getAddTrackWorkflowElements(),p={"Default add track workflow":X,"Add track JSON":$,...Object.fromEntries(m.map((e=>[e.name,e.ReactComponent])))},u=p[a]?a:"Default add track workflow",g=p[u];return n.createElement(n.Fragment,null,n.createElement(l.A,null,n.createElement(s.A,{value:u,onChange:e=>r(e.target.value)},Object.keys(p).map((e=>n.createElement(c.A,{key:e,value:e},e)))),n.createElement(o.A,null,"Type of add track workflow")),n.createElement("br",null),n.createElement(g,{model:t}))}))},63471:(e,t,a)=>{var n=a(24994);t.A=void 0;var r=n(a(40039)),l=a(70579);t.A=(0,r.default)((0,l.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")}}]);
//# sourceMappingURL=2716.c52f3a87.chunk.js.map