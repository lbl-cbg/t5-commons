"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4856],{24856:(e,t,l)=>{l.r(t),l.d(t,{default:()=>V});var n=l(65043),a=l(97368),o=l(95629),r=l(96233),i=l(64812),c=l(31913),s=l(17230),d=l(12722),m=l(54893),u=l.n(m),h=l(81160),f=l.n(h),p=l(91775),w=l(55253),v=l(70276),E=l(8591),g=l(42788),k=l(56894),b=l(71716),C=l(10155),S=l(98082),A=l(94682);function y(e){let{model:t}=e;const{faceted:l}=t,[a,r]=(0,n.useState)(null),{showOptions:i,showFilters:c,showSparse:s,useShoppingCart:d}=l;return n.createElement(n.Fragment,null,n.createElement(E.Ay,{container:!0,spacing:4,alignItems:"center"},n.createElement(E.Ay,{item:!0},n.createElement(g.A,{label:"Search...",value:l.filterText,onChange:e=>l.setFilterText(e.target.value),InputProps:{endAdornment:n.createElement(k.A,{position:"end"},n.createElement(b.A,{onClick:()=>l.setFilterText("")},n.createElement(C.A,null)))}})),n.createElement(E.Ay,{item:!0},n.createElement(b.A,{onClick:e=>r(e.currentTarget)},n.createElement(S.A,null))),n.createElement(E.Ay,{item:!0},n.createElement(A.A,{model:t}))),n.createElement(o.Menu,{anchorEl:a,open:!!a,onClose:()=>r(null),onMenuItemClick:(e,t)=>{t(),r(null)},menuItems:[{label:"Add tracks to selection instead of turning them on/off",onClick:()=>l.setUseShoppingCart(!d),type:"checkbox",checked:d},{label:"Show sparse metadata columns",onClick:()=>l.setShowSparse(!s),checked:s,type:"checkbox"},{label:"Show facet filters",onClick:()=>l.setShowFilters(!c),checked:c,type:"checkbox"},{label:"Show extra table options",onClick:()=>l.setShowOptions(!i),checked:i,type:"checkbox"}]}))}var x=l(69392),M=l(78632),F=l(94496),T=l(17434),O=l(15384),H=l(22505);const N=(0,v.makeStyles)()((e=>({facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}})));function z(e){let{onClick:t}=e;return n.createElement(x.A,{title:"Clear selection on this facet filter"},n.createElement(b.A,{onClick:()=>t(),size:"small"},n.createElement(C.A,null)))}function I(e){let{visible:t,onClick:l}=e;return n.createElement(x.A,{title:"Minimize/expand this facet filter"},n.createElement(b.A,{onClick:()=>l(),size:"small"},t?n.createElement(O.A,null):n.createElement(H.A,null)))}const R=(0,r.observer)((function(e){let{column:t,vals:l,model:a}=e;const{classes:o}=N(),[r,i]=(0,n.useState)(!0),{faceted:c}=a,{filters:s}=c,{field:d}=t;return n.createElement(M.A,{className:o.facet,fullWidth:!0},n.createElement("div",null,n.createElement(F.A,{component:"span"},d),n.createElement(z,{onClick:()=>c.setFilter(d,[])}),n.createElement(I,{visible:r,onClick:()=>i(!r)})),r?n.createElement(T.A,{multiple:!0,native:!0,className:o.select,value:s.get(t.field)||[],onChange:e=>{c.setFilter(t.field,[...e.target.options].filter((e=>e.selected)).map((e=>e.value)))}},l.sort(((e,t)=>e[0].localeCompare(t[0]))).map((e=>{let[t,l]=e;return n.createElement("option",{key:t,value:t},(0,p.coarseStripHTML)(t)," (",l,")")}))):null)}));var W=l(9123);const L=(0,r.observer)((function(e){let{rows:t,columns:l,model:a}=e;var o,r;const{faceted:i}=a,{filters:c}=i,s=l.slice(1),d=new Map(s.map((e=>[e.field,new Map]))),m=i.filters.keys(),u=s.map((e=>e.field)),h=new Set;for(const n of m)(null===(o=c.get(n))||void 0===o?void 0:o.length)&&h.add(n);for(const n of u)h.add(n);let f=t;for(const n of h){const e=d.get(n);for(const l of f){const t=(0,W.a)(n,l),a=e.get(t);t&&(void 0===a?e.set(t,1):e.set(t,a+1))}const t=(null===(r=c.get(n))||void 0===r?void 0:r.length)?new Set(c.get(n)):void 0;f=f.filter((e=>void 0===t||t.has((0,W.a)(n,e))))}return n.createElement("div",null,s.map((e=>n.createElement(R,{key:e.field,vals:[...d.get(e.field)],column:e,model:a}))))}));var j=l(72387);const B=(0,v.makeStyles)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},resizeHandle:{marginLeft:5,background:"grey",width:5}}),D=.75,P=(0,r.observer)((function(e){let{model:t}=e;var l;const{classes:a}=B(),{view:r,selection:m,shownTrackIds:h,faceted:v}=t,{rows:E,panelWidth:g,showFilters:k,useShoppingCart:b,showOptions:C,filteredRows:S,filteredNonMetadataKeys:A,filteredMetadataKeys:x,visible:M,widths:F}=v,{pluginManager:T}=(0,p.getEnv)(t),{ref:O,scrollLeft:H}=(0,w.useResizeBar)(),N=(0,p.useDebounce)(F,200),z=[{field:"name",hideable:!1,renderCell:e=>{const{value:l,row:o}=e,{id:r,conf:i}=o;return n.createElement("div",{className:a.cell},n.createElement(u(),{html:l}),n.createElement(j.A,{id:r,conf:i,trackId:r,model:t}))},width:null!==(l=N.name)&&void 0!==l?l:100},...A.map((e=>{var t;return{field:e,width:null!==(t=N[e])&&void 0!==t?t:100,renderCell:e=>{const t=e.value;return t?n.createElement(u(),{className:a.cell,html:t}):""}}})),...x.map((e=>{var t;return{field:"metadata.".concat(e),headerName:["name",...A].includes(e)?"".concat(e," (from metadata)"):e,width:null!==(t=N["metadata."+e])&&void 0!==t?t:100,valueGetter:t=>t.row.metadata[e],renderCell:t=>{const l=t.row.metadata[e];return l?n.createElement(u(),{className:a.cell,html:l}):""}}}))];return n.createElement(n.Fragment,null,n.createElement(y,{model:t}),n.createElement("div",{ref:O,style:{display:"flex",overflow:"hidden",height:window.innerHeight*D,width:window.innerWidth*D}},n.createElement("div",{style:{height:window.innerHeight*D,width:window.innerWidth*D-(k?g:0)}},n.createElement(f(),{checkbox:!0,widths:Object.values(F).map((e=>null!==e&&void 0!==e?e:100)),setWidths:e=>v.setWidths(Object.fromEntries(Object.entries(F).map(((t,l)=>[t[0],e[l]])))),scrollLeft:H}),n.createElement(s.zh,{rows:S,columnVisibilityModel:M,onColumnVisibilityModelChange:e=>v.setVisible(e),columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,onRowSelectionModelChange:e=>{if(b){const l=(0,c.getRoot)(t),n=T.pluggableConfigSchemaType("track");t.setSelection(e.map((e=>(0,c.resolveIdentifier)(n,l,e))))}else{const l=h,n=new Set(e);(0,i.transaction)((()=>{[...l].filter((e=>!n.has(e))).map((e=>r.hideTrack(e))),[...n].filter((e=>!l.has(e))).map((e=>{r.showTrack(e),t.addToRecentlyUsed(e)}))}))}},rowSelectionModel:b?m.map((e=>e.trackId)):[...h],slots:{toolbar:C?d.O:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:z,rowHeight:25})),k?n.createElement(n.Fragment,null,n.createElement(o.ResizeHandle,{vertical:!0,onDrag:e=>v.setPanelWidth(g-e),className:a.resizeHandle}),n.createElement("div",{style:{width:g,overflow:"auto"}},n.createElement(L,{model:t,rows:E,columns:z}))):null))})),V=(0,r.observer)((function(e){const{handleClose:t}=e;return n.createElement(o.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Faceted track selector"},n.createElement(a.A,null,n.createElement(P,{...e})))}))}}]);
//# sourceMappingURL=4856.5ea5492f.chunk.js.map